# 02. Пользовательские истории — FORMA

> Версия: v0.1 | Дата: 2026-02-14

## 1. Основные флоу

### Флоу 1 — "С нуля за 60 секунд"

```
Каталог стилей -> лайки -> Создать -> Генерация -> 3 превью ->
  Докрутить/Выбрать -> Наполнение -> Тариф -> Оплата -> Заказ
```

**Экраны:** S1 -> S2 -> S3 -> S4 -> S5 -> S8 -> S9 -> S10 -> S11 -> S12 -> S17

### Флоу 2 — "Увидел чужой дизайн -> ремикснул"

```
Страница дизайна -> Ремикс -> Генерация (3 превью) -> Докрутить -> Заказ
```

**Экраны:** S7 -> S6b -> S4 -> S5 -> ...

### Флоу 3 — "Лимит -> безлимит на период"

```
Генерация -> лимит -> экран покупки -> ЮKassa -> вернулся -> генерирует дальше
```

**Экраны:** S3/S6b -> L1 -> S11 -> (success) -> назад в S3/S6b

### Флоу 4 — "Докрутка"

```
S5 -> S6b -> S4 -> S5 (повторяем)
```

## 2. User Stories

### 2.1. Гость

| # | Как гость, я хочу... | Чтобы... |
|---|----------------------|----------|
| G1 | Просматривать каталог стилей | Понять, что это за продукт |
| G2 | Ставить лайки на стили | Система поняла мой вкус |
| G3 | Сгенерировать 2-5 дизайнов в сутки | Попробовать сервис |
| G4 | Видеть 3 превью (основное + 2 мутации) | Выбрать лучший вариант |
| G5 | Поделиться превью | Показать друзьям |
| G6 | Искать дизайны по словам и тегам | Найти подходящий стиль |
| G7 | Видеть популярные дизайны | Получить вдохновение |

### 2.2. Пользователь (авторизован)

| # | Как пользователь, я хочу... | Чтобы... |
|---|----------------------------|----------|
| U1 | Создавать дизайн через промпт + теги | Получить персональный блокнот |
| U2 | Получать 3 варианта при каждой генерации | Видеть разные идеи |
| U3 | Докручивать дизайн (менять теги, текст) | Добиться идеального результата |
| U4 | Делать ремикс чужого дизайна | Взять за основу то, что понравилось |
| U5 | Выбирать наполнение (клетка/линейка/точки/пустые) | Настроить внутренний блок |
| U6 | Выбирать комплектацию Base/Pro/Elite | Выбрать материалы и цену |
| U7 | Оплатить через ЮKassa | Оформить заказ |
| U8 | Видеть статус заказа и штрихкод | Отслеживать производство |
| U9 | Сохранять дизайны в избранное | Вернуться к ним позже |
| U10 | Купить безлимит за 100 ₽ | Генерировать сколько хочу |
| U11 | Видеть историю своих дизайнов | Управлять своими работами |
| U12 | Быстро заменять теги (золото->серебро) | Докручивать в 1 тап |

### 2.3. Админ

| # | Как админ, я хочу... | Чтобы... |
|---|---------------------|----------|
| A1 | Управлять тегами (CRUD, импорт CSV) | Развивать словарь |
| A2 | Управлять стилями каталога | Курировать витрину |
| A3 | Запускать batch-генерации | Наполнять каталог |
| A4 | Оценивать результаты 1-5 | Фильтровать качество |
| A5 | Управлять заказами (статусы, файлы) | Контролировать производство |
| A6 | Настраивать лимиты и цены | Управлять монетизацией |
| A7 | Видеть аудит-лог действий | Контролировать изменения |

## 3. Спецификация экранов (UI/UX Mobile-first)

### Общие принципы

- "Редакционный минимализм": мало шума, много воздуха, крупная типографика
- 1 главный CTA на экран
- Превью всегда в мокапе (обложка на блокноте)
- "В один тап": Докрутить, Поделиться, Заказать
- Share — ключ роста: кнопка всегда на видном месте

### Навигация (нижний tab bar)

1. **Каталог** — входные стили / редакция / дропы
2. **Создать** — промпт + теги
3. **Поиск**
4. **Избранное**
5. **Профиль**

### S0. Splash / Preload

- Лого FORMA
- "Редакция вкуса. Твой блокнот."
- Индикатор прогресса
- **Fail:** кнопка "Повторить"

### S1. Каталог (главная витрина)

Секции (вертикальная лента):
- "Выбери, что нравится" (кнопка "Начать"/"Продолжить")
- Редакция FORMA (горизонтальный скролл)
- Популярное сегодня
- Дроп / Коллекция недели
- Категории стилей

**Карточка дизайна:** мокап превью, название, 2-3 тега, метки ("Популярное", "Редакция", "Drop")

### S2. Онбординг вкуса — "Выбери, что нравится"

- Свайп-карточки или сетка
- Header: "Выбери 5 стилей — и мы соберем твой вкус"
- Кнопки: "Не мое" / "Нравится"
- Прогресс: "Выбрано: 0/5"
- После 5 лайков -> Bottom sheet: "Готово. Создадим блокнот в твоем стиле?"
- CTA: "Создать"

### S3. Создать (промпт + теги)

- Поле промпта (multiline)
- Placeholder: "Например: минималистичный морской стиль, серебро вместо золота..."
- Чипсы "Быстрые теги": Страна, Сезон, Стихия, Материал, Архитектура, Brand mood
- Блок "Основа стиля" (из онбординга)
- **CTA:** "Сгенерировать (Pro)" + "Будет 3 варианта"
- **Состояния:** GuestLimitWarning, DisabledCTA (пустой промпт)

### S4. Генерация (прогресс)

- "Собираем варианты"
- Шаги: "Собираем стиль" -> "Готовим 3 варианта" -> "Делаем превью"
- "Пока ждешь — посмотри популярное"
- **Timeout:** "Дольше обычного. Мы продолжим, а ты можешь вернуться"
- **Failed:** "Не получилось. Повторить" + "Изменить запрос"

### S5. Результат генерации — 3 превью (ключевой экран)

- Горизонтальная лента из 3 карточек (пейджинг)
- Карточка: мокап (крупно), плашка ("Основной" / "Мутация: заменили золото -> серебро")
- Кнопки на карточке: "Выбрать" (primary), "Докрутить" (secondary)
- Панель: Сохранить, Поделиться, Ремикс, "Что изменили?"
- После "Выбрать" -> CTA: "Продолжить -> Наполнение"
- **OneFailed:** "Этот вариант не получился" + "Пересобрать"

### S6. Поделиться (share sheet)

- Превью (мини), "Поделиться дизайном"
- Переключатель: "Показывать теги на картинке" (OFF по умолчанию)
- "Скопировать ссылку", "Скачать изображение", Системный share

### S6b. Докрутка (Refine)

- "Быстрые замены" (чипсы): золото/серебро/хром/медь, минимализм/люкс/винтаж/техно...
- Теги по вкладкам: Страны, Сезоны, Стихии, Архитектура, Материалы, Brand mood
- Поле "Скажи словами"
- Чекбокс: "Сохранить композицию (рекомендуем)"
- **CTA:** "Обновить (3 превью)"
- **Состояния:** TooManyTags, PolicyWarning (brand mood)

### S7. Страница дизайна (публичная)

- Большое превью + галерея
- Название, плашки ("Редакция FORMA", "Популярное", "Drop")
- Теги (только публичные)
- Кнопки: "Ремикснуть" (primary), "Сделать похожий", "Заказать"
- Блоки: "Ремиксы", "Похожие по вкусу"
- Секция "FORMA DNA": "Собрано из: ...", дата, ID

### S8. Наполнение (внутренний блок)

- Список: Клетка, Линейка, Точки, Пустые, Планер (если в MVP)
- Мини-превью разворота
- Параметры: нумерация страниц, язык (RU/EN)
- **CTA:** "Дальше"

### S9. Комплектация Base / Pro / Elite

- 3 карточки с ценой и отличиями
- Pro выделена по умолчанию
- Elite: плашка "Коллекционный уровень"
- **CTA:** "Оформить заказ"

### S10. Оформление заказа

- Контакты: имя, телефон, email
- Доставка: самовывоз/доставка, адрес
- Итог: комплектация, наполнение, цена
- **CTA:** "Оплатить" (ЮKassa)
- GuestCheckout: "Войти, чтобы сохранить заказ"

### S11. Оплата (ЮKassa)

- Переход на форму YooKassa
- Success -> S12, Cancel -> S10, Pending -> "Проверяем оплату..."

### S12. Заказ принят

- Номер заказа, статус
- FORMA DNA: QR на страницу дизайна
- Кнопки: "Отслеживать заказ", "Сделать еще один"

### S13. Поиск

- Поле поиска, фильтры-чипсы
- Результаты: дизайны / стили / промпты (вкладками)
- Сортировка: популярное / новое / для вас

### S14. Избранное

- Вкладки: "Дизайны", "Стили"
- Пустое: "Сохраняй дизайны — соберем твою коллекцию"

### S15. Профиль

- Гость: "Войти" (VK, Яндекс, T-Bank, Альфа, Gmail)
- Авторизован: Мои дизайны, Мои заказы, Лимит генераций, Настройки

### S16. Мои дизайны

- Список: превью-мокап, дата, статус
- Действия: Докрутить, Заказать, Поделиться, Удалить

### S17. Мои заказы

- Список: номер, дата, статус, сумма
- Детали: штрихкод, состав, статусы

### L1. Лимит исчерпан

- "Лимит генераций на сегодня исчерпан"
- **CTA:** "Включить безлимит за 100 ₽"
- Вторичная: "Войти", "Вернуться и отредактировать запрос"

## 4. Карта переходов

### 4.1. Глобальные правила

**CurrentDesign (черновик)** — всегда может существовать:
- выбранный стиль, промпт, теги, последний превью, наполнение, тариф
- Если пользователь уходит/возвращается — показываем "Продолжить"

**Гейт лимитов:** перед генерацией (S3, S6b) -> проверка лимита -> L1 если исчерпан

**Гейт оплаты (гость):** на S10 перед оплатой -> требовать Auth (рекомендуется)

### 4.2. Таблица переходов

| Экран | Действие | Следующий | Условие |
|-------|----------|-----------|---------|
| S0 | App open | S0 | |
| S0 | Loaded OK | S1 | |
| S0 | Load failed + "Повторить" | S0 | |
| S1 | "Начать выбор вкуса" | S2 | |
| S1 | Тап по дизайну | S7 | |
| S1 | "Продолжить последний" | S5 или S3 | Есть CurrentDesign |
| S1 | Навигация | S3/S13/S14/S15 | |
| S2 | "Нравится" | S2 (следующая карточка) | Сохраняем preference |
| S2 | "Не мое" | S2 (следующая) | |
| S2 | "Пропустить" | S3 | Без/частичный профиль |
| S2 | 5 лайков -> "Создать" | S3 | С заполненным пресетом |
| S3 | "Сгенерировать" | S4 | Лимит OK |
| S3 | "Сгенерировать" | L1 | Лимит исчерпан |
| S3 | "Сменить стили" | S2 | |
| S4 | Все 3 готовы | S5 | |
| S4 | Partial (1-2 готовы) | S5 | С заглушками |
| S4 | Failed | S4 (ошибка) | "Повторить" / "Изменить" |
| S4 | Timeout | S16 | "В мои дизайны" |
| S5 | "Выбрать" | S5 (+ CTA) | Помечаем selected_preview |
| S5 | "Докрутить" | S6b | |
| S5 | "Продолжить -> Наполнение" | S8 | После выбора |
| S5 | "Сохранить" | S5 | Для гостя — локально |
| S5 | "Поделиться" | S6 | |
| S5 | "Ремикс" | S6b | Создаем fork |
| S6 | "Скопировать ссылку" | S6 -> S5 | |
| S6 | Системный share | S5 | |
| S6b | "Обновить (3 превью)" | S4 | Лимит OK |
| S6b | "Обновить (3 превью)" | L1 | Лимит исчерпан |
| S7 | "Ремикснуть" | S6b | Создаем fork |
| S7 | "Сделать похожий" | S3 | Теги/стиль как пресет |
| S7 | "Заказать" | S8 | |
| S8 | Выбрать наполнение | S8 | |
| S8 | "Дальше" | S9 | |
| S9 | Выбор тарифа | S9 | |
| S9 | "Оформить заказ" | S10 | |
| S10 | "Оплатить" | S11 | Auth gate если гость |
| S11 | Payment success | S12 | |
| S11 | Payment cancel | S10 | |
| S12 | "Отслеживать" | S17a | |
| S12 | "Сделать еще" | S3 | |
| S13 | Тап по дизайну | S7 | |
| S13 | Тап по стилю | S3 | Как пресет |
| S14 | Тап по дизайну | S7 | |
| S15 | "Войти" | Auth -> S15 | |
| S15 | "Мои дизайны" | S16 | |
| S15 | "Мои заказы" | S17 | |
| L1 | "Безлимит за 100 ₽" | S11 | Покупка генераций |
| L1 | Оплата успех | S3/S6b | Возврат в точку старта |
| L1 | "Войти" | Auth -> L1 | Пересчет лимита |

### 4.3. DeepLink маршруты

| Маршрут | URL | Экран |
|---------|-----|-------|
| Дизайн | `/d/:slug` или `/designs/:hashid` | S7 |
| QR из DNA Card | то же | S7 |
| Заказ | `/orders/:id` | S17a (по токену) |

## 5. Микрокопи FORMA (тональность)

- "Собираем варианты" (не "processing...")
- "Идея от редакции" (для мутаций)
- "Докрутить" (ключевое слово)
- "Сделать похожий"
- "Вкус сохранен"

## 6. События аналитики

### Вкус и каталог
- `catalog_open`, `style_like`, `style_dislike`
- `onboarding_complete` (likes_count, time_spent)
- `catalog_design_open` (design_id, source)

### Создание и генерации
- `create_open`, `tag_add`, `tag_remove`
- `generation_start` (source, is_guest, has_taste_profile)
- `generation_success` (latency_ms, previews_ok)
- `generation_fail` (error_type)

### Работа с превью
- `preview_view` (index), `preview_select` (index)
- `refine_open`, `refine_apply_quick_swap`, `refine_submit`

### Социальность
- `share_open`, `share_complete` (channel)
- `design_open_via_deeplink`

### Заказ
- `filling_select`, `plan_select` (base/pro/elite)
- `checkout_start`, `payment_start`, `payment_success`
- `order_created`

### Лимиты
- `limit_hit` (guest/auth), `unlimited_offer_view`, `unlimited_purchase_success`
